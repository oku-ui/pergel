---
title: Installation
description: 'Pergel Nuxt Module for BullMQ'
links:
  - label: 'bullmq'
    icon: i-simple-icons-npm
    to: https://www.npmjs.com/package/bullmq
---

1. Project configuration:

::code-group
```ts [nuxt.config.ts]
export default defineNuxtConfig({
  modules: ['@pergel/nuxt'],
  pergel: {
    projects: {
      myproject: {
        // ... other modules
        bullmq: true,
      },
      // bookList: {
      //  ses: false
      // },
    },
  },
})
```
::

::callout{color="amber" icon="i-ph-warning-duotone"}
Node >= 20.8.0 is required.
Nuxt >= 3.9.0 is required.
::


2. Auto install dependencies:

::code-group
```sh [pnpm]
pergel install
```
::

:read-more{title="Install Pergel CLI" to="/pergel/cli"}

3. Add your server plugin:

This code blog is a listener.

::code-group
```ts [server/plugin/bullmqTest.ts]
import type { Job } from 'bullmq'

export default pergelTest().bullmq().nitroPlugin({
  setup: ({ useScheduler }) => {
    const { start } = useScheduler('email')

    const isStarted = start(
      consumeMethod,
    )

    if (!isStarted)
      console.warn('Redis connection not started')
  },
})

// Example method
async function consumeMethod(job: Job<any, any, string>) {
  console.warn('Coming data', job.data)
  const result = await sleep(3000)
  console.warn(result)
}

function sleep(time: number) {
  return new Promise((resolve) => {
    console.warn('Process started')
    setTimeout(() => {
      resolve('Process finished')
    }, time)
  })
}

```

::

```ts [composables]
pergelMyproject().bullmq().nitroComposable({})
```

4. Use anywhere server side:

::code-group
```ts [server/api/books.ts]
export default defineEventHandler(async () => {
  const ID = Math.random().toString(36).substring(7) // generate random id

  const { schedule } = pergelTest().bullmq().useScheduler({
    queueName: 'email', // queue name used in server/plugin/bullmqTest.ts
  })

  if (schedule === null)
    return 'BullMQ not started'

  const QUEUE_NAME = 'email'

  schedule(QUEUE_NAME, {
    id: ID,
    name: '1020',
    data: {
      email: 'test',
      body: 'Welcome to our website',
    },
    options: {
      delay: 1000,
      attempts: 3,
    },
  }, {
    jobId: ID,
    removeOnComplete: {
      age: 30,
    },
    attempts: 5,
    backoff: {
      type: 'exponential',
      delay: 1000,
    },
  })

  return 'Hello BullMQ'
})
```

::

::callout{icon="i-ph-check-circle-duotone" color="green"}
Well done! You have successfully installed the module.
::

::callout{icon="i-ph-check-circle-duotone" color="yellow"}
 More information about the module [API](./2.api.md)
::

